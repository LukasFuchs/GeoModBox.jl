<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>General · GeoModBox.jl</title><meta name="title" content="General · GeoModBox.jl"/><meta property="og:title" content="General · GeoModBox.jl"/><meta property="twitter:title" content="General · GeoModBox.jl"/><meta name="description" content="Documentation for GeoModBox.jl."/><meta property="og:description" content="Documentation for GeoModBox.jl."/><meta property="twitter:description" content="Documentation for GeoModBox.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeoModBox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Governing Equation</span><ul><li><a class="tocitem" href="../GESolution/">Solution</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Heat Diffusion Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>General</a><ul class="internal"><li><a class="tocitem" href="#Heat-Diffusion-Equation"><span>Heat Diffusion Equation</span></a></li><li><a class="tocitem" href="#Heat-Advection-Equation"><span>Heat Advection Equation</span></a></li></ul></li><li><a class="tocitem" href="../DiffOneD/">1D</a></li><li><a class="tocitem" href="../DiffTwoD/">2D</a></li></ul></li></ul></li><li><a class="tocitem" href="../listoffunctions/">List of functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Governing Equation</a></li><li><a class="is-disabled">Heat Diffusion Equation</a></li><li class="is-active"><a href>General</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>General</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/LukasFuchs/GeoModBox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/docs/src/man/DiffMain.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Energy-Conservation-Equation"><a class="docs-heading-anchor" href="#Energy-Conservation-Equation">Energy Conservation Equation</a><a id="Energy-Conservation-Equation-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-Conservation-Equation" title="Permalink"></a></h1><p>The conservation of energy is a fundamental principle in physics and defines that the loss and generation of energy needs to be equal within a closed system. In terms of a geodynamical problem, energy is described by temperature, which is transported mainly through <em>conductive</em> and <em>convective</em> processes, such that a general energy equation is defined as followed (assuming only radioactive heat sources):</p><p class="math-container">\[\begin{equation}
\left(\frac{\partial E}{\partial t} + \overrightharpoon{v} \cdot \overrightharpoon{\nabla} E\right) + \frac{\partial q_{i}}{\partial x_{i}} = \rho H,
\end{equation}\]</p><p>where the energy is described as <span>$E=c_{p} \rho T$</span>, and <span>$c_{p}$</span> is the specific heat capacity [ <span>$J/kg/K$</span> ], <span>$\rho$</span> is a reference density [ <span>$kg/m^{3}$</span> ], <span>$T$</span> is the temperature [ <span>$K$</span> ], <span>$t$</span> is the time [ <span>$s$</span> ], <span>$\overrightharpoon{v}$</span> is the velocity vector [ <span>$m/s$</span> ], <span>$q_{i}$</span> is the heat flux in direction of <span>$i$</span> [ <span>$W/m^{2}$</span> ], <span>$\frac{\partial}{\partial{x_i}}$</span> is a directional derivative in direction of <span>$i$</span>, and <span>$H$</span> the heat production rate per mass [ <span>$W/kg$</span> ]. The repeated index means a summation of derivatives. This conservation law contains the variation of the heat flux in a certain direction, where the heat flux is defined by the Fourier’s law as followed: </p><p class="math-container">\[\begin{equation}
\overrightharpoon{q} = - k \overrightharpoon{\nabla} T,
\end{equation}\]</p><p>where <span>$k$</span> is the thermal conductivity [ <span>$W/m/K$</span> ]. The heat flux is the amount of heat that passes through a unit surface area, per unit time and is positive in the direction of decreasing temperature, that is in the case when the temperature gradient is negative. The <em>temperature conservation equation</em>, or <em>temperature equation</em>, in an Eulerian form can then be written as: </p><p class="math-container">\[\begin{equation}
\rho c_p \left(\frac{\partial T}{\partial t} + \overrightharpoon{v} \cdot \overrightharpoon{\nabla} T\right) = -\frac{\partial q_i}{\partial x_i} + \rho H.
\end{equation}\]</p><p>This form of the <em>temperature equation</em> describes the variation of temperature due to a <em>conductive</em> (right hand side of the equation) and <em>convective</em> (left hand side of the equation) process. For a matter of simplicity, one can consider those terms in a separate manner and solve the <em>temperature equation</em> using an <em>operator splitting</em> method, that is one first solves the <em>convective</em> part, followed by the <em>conductive</em> part.</p><h2 id="Heat-Diffusion-Equation"><a class="docs-heading-anchor" href="#Heat-Diffusion-Equation">Heat Diffusion Equation</a><a id="Heat-Diffusion-Equation-1"></a><a class="docs-heading-anchor-permalink" href="#Heat-Diffusion-Equation" title="Permalink"></a></h2><p>The <code>GeoModBox.jl</code> provides different finite difference (<strong>FD</strong>) schemes to solve the <em>diffusive part</em> of the time-dependent or steady-state <em>temperature equation</em> including radioactive heating, in <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/src/HeatEquation/1Dsolvers.jl">1-D</a> and <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/src/HeatEquation/2Dsolvers.jl">2-D</a>. The solvers include: </p><ul><li>forward Euler, </li><li>backward Euler, </li><li>Crank-Nicholson approach, and </li><li>Alternate Direct Implicit (ADI).</li></ul><p>For more details regarding each FD-scheme see the documentation of the <a href="../DiffOneD/">1-D</a> and <a href="../DiffTwoD/">2-D</a> solvers, respectively. Currently, only <em>Dirichlet</em> and <em>Neumann</em> thermal boundary conditions are available and most functions assume constant thermal parameters (except for the 1-D and some 2-D solvers). For more details on the implementation of the solvers see the <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/src/HeatEquation/">src/HeatEquation</a> directory. </p><p>The examples of solving the <em>heat diffusion equation</em> include, amongst others: </p><ul><li>the determination of an <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/examples/DiffusionEquation/1D/OceanicGeotherm_1D.jl">oceanic</a> and <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/examples/DiffusionEquation/1D/ContinentalGeotherm_1D.jl">continental</a> 1-D geotherm profile, </li><li><a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/examples/DiffusionEquation/1D/Heat_1D_discretization.jl">a comparison of the different <strong>FD</strong>-schemes applied on a 1-D gaussian temperature anomaly</a>, </li><li><a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/examples/DiffusionEquation/2D/Gaussian_Diffusion.jl">a 2-D resolution test for each <strong>FD</strong>-scheme using a gaussian temperature anomaly</a>, and</li><li><a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/examples/DiffusionEquation/2D/Poisson_ResTest.jl">a resolution test for a 2-D poisson problem</a>. </li></ul><p>For detailed information and explenations of the examples see the <a href="../Examples/">documentation</a> and for additional examples see the <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/examples/DiffusionEquation/">example directory</a>.</p><p>The <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/exercises/">exercises</a> include</p><ul><li><a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/exercises/02_1D_Heat_explicit.ipynb">the forward</a> and <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/exercises/03_1D_Heat_implicit.ipynb">backward</a> Euler method to solve the 1-D diffusion equation, </li><li><a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/exercises/04_2D_Diffusion_Stationary.ipynb">a 2-D poisson problem</a>, and</li><li>a time-dependent temperature distribution within the lithosphere assuming a <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/exercises/05_2D_Diffusion_TD_Plume.ipynb">plume</a> or <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/exercises/05_2D_Diffusion_TD_Sill.ipynb">sill</a>.</li></ul><h2 id="Heat-Advection-Equation"><a class="docs-heading-anchor" href="#Heat-Advection-Equation">Heat Advection Equation</a><a id="Heat-Advection-Equation-1"></a><a class="docs-heading-anchor-permalink" href="#Heat-Advection-Equation" title="Permalink"></a></h2><p>To solve the <em>advective part</em> of the <em>temperature equation</em>, the <code>GeoModBox.jl</code> provides the following different methods: </p><ul><li>the upwind scheme,</li><li>the staggered-leaped frog scheme, </li><li>the semi-lagrangian advection scheme, and</li><li>passive tracers/markers. </li></ul><p>For more details regarding each advection scheme see the <a href="../AdvectMain/">documentation</a>. The routines are structured in such a way, that any property can be advected with the first <strong>three</strong> advection methods listed above, as long as the property is defined on the <em>centroids</em> including <em>ghost nodes</em> on all boundaries. The velocity to advect the property also needs to be defined at the <em>centroids</em>. Using passive tracers, one can, so far, choose to either advect the (absolut) temperature or the phase ID. In case of advecting the phase ID, one must define a certain rheology (<span>$\eta$</span>) and/or density (<span>$\rho$</span>) associated to each phase. The phase ID is used to interpolate the corresponding property from the tracers to the <em>centroids</em> or the <em>vertices</em> (e.g., in the case of the viscosity). The tracers can be initialized with a certain random perturbation for their initial position and are advected using Runge-Kutta 4th order. For the tracer advection one can use the staggered velocity grid. </p><p>For more details on the implementation of the tracer advection see <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/src/Tracers/2Dsolvers.jl">here</a> or <a href="../AdvectMain/">here</a>. The solvers for the tracer advection method are located in <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/src/Tracers/">src/Tracers</a>, where the remaining advection routines are located in <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/src/AdvectionEquation/">src/AdvectionEquation</a>. </p><p>A key aspect for the advection is the <strong>amplitude</strong> and the <strong>shape</strong> of an advected property. For example, in case of a rigid body rotation, none of them should change. Depending on the method, however, numerical diffusion or interpolation effects can lead to strong deviations. Thus, care needs to be taken with respect to solving the <em>advection equation</em>. </p><p>The <code>GeoModBox.jl</code> contains several <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/src/InitialCondition/2Dini.jl">routines</a> to setup a certain initial anomaly, either for properties defined on their correspondig grid (i.e., temperature, velocity, or phase) or for tracers. Within the examples and the exercise one can choose different initial temperature and velocity conditions. See <a href="../Ini/">here</a> for a more detailed explenation of the initial condition setup. </p><p>The examples for a two dimensional advection problem include:</p><ul><li><a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/examples/AdvectionEquation/2D_Advection.jl">a 2-D advection, assuming a constant velocity field (e.g., a rigid body rotation)</a>, and</li><li><a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/examples/AdvectionEquation/2D_Advection_ResolutionTest.jl">a resolution test of the same advection example</a>. </li></ul><p>For detailed information and explenations of the examples see the <a href="../Examples/">documentation</a>.</p><p>The exercises include a</p><ul><li><a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/exercises/06_1D_Advection.ipynb">1-D advection of a gaussian or block anomaly</a>, and</li><li><a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/exercises/07_2D_Energy_Equation.ipynb">a 2-D advection coupled with the solution of the diffusion equation</a>.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../GESolution/">« Solution</a><a class="docs-footer-nextpage" href="../DiffOneD/">1D »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Monday 7 April 2025 19:55">Monday 7 April 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
