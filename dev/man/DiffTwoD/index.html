<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>2D · GeoModBox.jl</title><meta name="title" content="2D · GeoModBox.jl"/><meta property="og:title" content="2D · GeoModBox.jl"/><meta property="twitter:title" content="2D · GeoModBox.jl"/><meta name="description" content="Documentation for GeoModBox.jl."/><meta property="og:description" content="Documentation for GeoModBox.jl."/><meta property="twitter:description" content="Documentation for GeoModBox.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeoModBox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Governing Equation</span><ul><li><a class="tocitem" href="../GESolution/">Solution</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Heat Diffusion Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../DiffMain/">General</a></li><li><a class="tocitem" href="../DiffOneD/">1D</a></li><li class="is-active"><a class="tocitem" href>2D</a><ul class="internal"><li><a class="tocitem" href="#Discretization"><span>Discretization</span></a></li><li><a class="tocitem" href="#Numerical-Schemes"><span>Numerical Schemes</span></a></li><li><a class="tocitem" href="#Steady-State-Solution"><span>Steady State Solution</span></a></li></ul></li></ul></li></ul></li><li><a class="tocitem" href="../listoffunctions/">List of functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Governing Equation</a></li><li><a class="is-disabled">Heat Diffusion Equation</a></li><li class="is-active"><a href>2D</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>2D</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/LukasFuchs/GeoModBox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/docs/src/man/DiffTwoD.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Temperature-Equation-(2D)"><a class="docs-heading-anchor" href="#Temperature-Equation-(2D)">Temperature Equation (2D)</a><a id="Temperature-Equation-(2D)-1"></a><a class="docs-heading-anchor-permalink" href="#Temperature-Equation-(2D)" title="Permalink"></a></h1><p>In two dimesions (<span>$x$</span> and <span>$y$</span>), the <em>conductive</em> part of the <em>temperature equation</em> is described by (assuming only radiogenic heating):</p><p class="math-container">\[\begin{equation}
\rho c_p \frac{\partial T}{\partial t} = -\frac{\partial q_x}{\partial x} -\frac{\partial q_y}{\partial y} + \rho H, 
\end{equation}\]</p><p>or including Fourier’s law (assuming variable thermal parameters):</p><p class="math-container">\[\begin{equation}
\rho c_p \frac{\partial T}{\partial t} = \frac{\partial}{\partial x} k \frac{\partial T}{\partial x} + \frac{\partial}{\partial y} k \frac{\partial T}{\partial y} + \rho H.
\end{equation}\]</p><p>Assuming that the thermal parameters are constant, equation <span>$(2)$</span> simplifies to: </p><p class="math-container">\[\begin{equation}
\frac{\partial T}{\partial t} = \kappa \left(\frac{\partial^2 T}{\partial x^2} + \frac{\partial^2 T}{\partial y^2}\right) + \frac{Q}{\rho c_p},
\end{equation}\]</p><p>where <span>$\kappa = k/\rho /c_p$</span> is the thermal diffusivity [ <span>$m^2$</span> ] and <span>$Q=\rho H$</span> is the heat production rate per volume [ <span>$W/m^3$</span> ]. In case of an explicit 2-D finite difference approach, the heat diffusion stability criterion is defined as </p><p class="math-container">\[\begin{equation}
\Delta{t} &lt; \frac{1}{2 \kappa \left(\frac{1}{\Delta{x^2}}+\frac{1}{\Delta{y^2}}\right)}
\end{equation}\]</p><p>(assuming equal grid spacing in <span>$x$</span>- and <span>$y$</span>-direction).</p><h2 id="Discretization"><a class="docs-heading-anchor" href="#Discretization">Discretization</a><a id="Discretization-1"></a><a class="docs-heading-anchor-permalink" href="#Discretization" title="Permalink"></a></h2><p>To numerically solve equation <span>$(3)$</span> one needs to discretize the numerical domain and assign the parameters to their corresponding nodes. </p><p><img src="../../assets/2D_Diffusion_Grid.jpg" alt="2DDiffusionGrid"/></p><p><strong>Figure 1. 2-D Discretization.</strong> <em>Conservative finite difference grid</em> to solve the 2-D <em>conductive</em> part of the <em>temperature equation</em>. The temperature is defined on the <em>centroids</em> (red circles) and the heat flux between the <em>vertices</em> (horizontal - blue x, vertical - green square). The temperature <em>ghost nodes</em> (grey circles) are used to properly implement <em>Dirichlet</em> and <em>Neumann</em> thermal boundary conditions.  </p><h3 id="Explicit,-FTCS-(or-Forward-Euler-Method)"><a class="docs-heading-anchor" href="#Explicit,-FTCS-(or-Forward-Euler-Method)">Explicit, FTCS (or Forward Euler Method)</a><a id="Explicit,-FTCS-(or-Forward-Euler-Method)-1"></a><a class="docs-heading-anchor-permalink" href="#Explicit,-FTCS-(or-Forward-Euler-Method)" title="Permalink"></a></h3><p>In two dimensions, the partial derivatives of equation <span>$(3)$</span> can be approximated by an explicit FTCS finite difference approach by: </p><p class="math-container">\[\begin{equation}
\frac{T_{i,j}^{n+1} - T_{i,j}^{n} }{\Delta t} = \kappa \left( \frac{T_{i-1,j}^{n} - 2T_{i,j}^{n} + T_{i+1,j}^{n}}{\Delta{x}^2} + \frac{T_{i,j-1}^{n} - 2T_{i,j}^{n} + T_{i,j+1}^{n}}{\Delta{z^2}} \right) + \frac{Q_{i,j}^n}{\rho c_p}
\end{equation}\]</p><p>where <span>$i$</span> and <span>$j$</span> are the horizontal and vertical index of the numerical finite difference grid, <span>$n$</span> is the time step index, <span>$\Delta{t}$</span> is the time step, and <span>$\Delta{x}$</span> and <span>$\Delta{y}$</span> are the horizontal and vertical grid resolution, respectively. Equation <span>$(5)$</span> contains know and unknow parameters and one can rearrange them to solve the equation for the unknowns as:</p><p class="math-container">\[\begin{equation}
T_{i,j}^{n+1} = T_{i,j}^{n} + a\left(T_{i-1,j}^{n} - 2T_{i,j}^{n} + T_{i+1,j}^{n}\right) + b\left(T_{i,j-1}^{n} - 2T_{i,j}^{n} + T_{i,j+1}^{n}\right) + \frac{Q_{i,j}^n \Delta{t}}{\rho c_p}, 
\end{equation}\]</p><p>where <span>$a = \frac{\kappa \Delta{t}}{\Delta{x^2}}$</span> and <span>$b = \frac{\kappa \Delta{t}}{\Delta{y^2}}$</span>. For more details on how this is implemented see <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/src/HeatEquation/2Dsolvers.jl"><em>ForwardEuler.jl</em></a>.</p><h4 id="Boundary-Conditions"><a class="docs-heading-anchor" href="#Boundary-Conditions">Boundary Conditions</a><a id="Boundary-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-Conditions" title="Permalink"></a></h4><p>The <em>Dirichlet</em> boundary condition defines a constant temperature along the boundary, such that the temperatures at the left (<strong>West</strong>), right (<strong>East</strong>), bottom (<strong>South</strong>), and top (<strong>North</strong>) <em>ghost nodes</em> are defined as:</p><p class="math-container">\[\begin{equation}
T_{G,W} = 2T_{BC,W} - T_{1,:},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
T_{G,E} = 2T_{BC,E} - T_{ncx,:},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
T_{G,S} = 2T_{BC,S} - T_{:,1},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
T_{G,N} = 2T_{BC,N} - T_{:,ncy},
\end{equation}\]</p><p>where <span>$T_{G,W}$</span>, <span>$T_{G,E}$</span>, <span>$T_{G,S}$</span>, and <span>$T_{G,N}$</span> and <span>$T_{BC,W}$</span>, <span>$T_{BC,E}$</span>, <span>$T_{BC,S}$</span>, and <span>$T_{BC,N}$</span> are the temperature at the left, right, bottom, and top <em>ghost nodes</em> and the constant temperatures at the left, right, bottom, and top boundary, respectively. </p><p>The <em>Neumann</em> boundary condition defines that the variation of a certain parameter across the boundary is defined, that is, for example, the temperature across the boundary or thermal heat flux <span>$q$</span> through the boundary. The temperature at the <em>ghost nodes</em> is then defined as: </p><p class="math-container">\[\begin{equation}
T_{G,W} = T_{1,:} - c_{W} \Delta{x},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
T_{G,E} = T_{ncx,:} + c_{E} \Delta{x},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
T_{G,S} = T_{:,1} - c_{S} \Delta{y},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
T_{G,N} = T_{:,ncy} + c_{N} \Delta{y},
\end{equation}\]</p><p>where </p><p class="math-container">\[\begin{equation}
\left. c_{W} = \frac{\partial{T}}{\partial{x}} \right\vert_{W}, \left. c_{E} = \frac{\partial{T}}{\partial{x}} \right\vert_{E}, 
\left. c_{S} = \frac{\partial{T}}{\partial{y}} \right\vert_{S},
\left. c_{N} = \frac{\partial{T}}{\partial{y}} \right\vert_{N},
\end{equation}\]</p><p>are the constant heat fluxes along the left, right, bottom, and top boundary, respectively. </p><p>Now, one can solve equation <span>$(6)$</span> for the temperature on the centroids at the next time step using the defined temperature at the <em>ghost nodes</em> where necessary.  </p><h2 id="Numerical-Schemes"><a class="docs-heading-anchor" href="#Numerical-Schemes">Numerical Schemes</a><a id="Numerical-Schemes-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-Schemes" title="Permalink"></a></h2><p>Within the example code <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/examples/DiffusionEquation/2D/Gaussian_Diffusion.jl">Gaussian_Diffusion.jl</a> different numerical schemes are used to solve the <em>conductive</em> part of the <em>temperature equation</em> (i.e., <em>explicit</em>, <em>implicit</em>, <em>Crank-Nicholson Approach</em>, and <em>defection correction</em>) and the results are compared with the analytical solution. In the following, each discretization scheme is briefly described. </p><h3 id="Implicit-(or-Backward-Euler-Method)"><a class="docs-heading-anchor" href="#Implicit-(or-Backward-Euler-Method)">Implicit (or Backward Euler Method)</a><a id="Implicit-(or-Backward-Euler-Method)-1"></a><a class="docs-heading-anchor-permalink" href="#Implicit-(or-Backward-Euler-Method)" title="Permalink"></a></h3><p>In 2-D, the <em>temperature equation</em> is then given as: </p><p class="math-container">\[\begin{equation}
\frac{T_{i,j}^{n+1}-T_{i,j}^n}{\Delta t} = 
\kappa \left( 
    \frac{T_{i-1,j}^{n+1}-2T_{i,j}^{n+1}+T_{i+1,j}^{n+1}}{\Delta x^2} + 
    \frac{T_{i,j-1}^{n+1}-2T_{i,j}^{n+1}+T_{i,j+1}^{n+1}}{\Delta y^2} 
    \right) + 
\frac{Q_{i}^n}{\rho c_p},
\end{equation}\]</p><p>where <span>$n$</span> is the current and <span>$n+1$</span> the next time step, <span>$\Delta{t}$</span> is the time step length, <span>$\Delta{x}$</span> and <span>$\Delta{y}$</span> are the horizontal and vertical grid spacing, and <span>$i$</span> and <span>$j$</span> are the horizontal and vertical indeces, respectively. Rearranging equation <span>$(16)$</span> into known and unknown variables, one obtains a linear system of equations in the form of: </p><p class="math-container">\[\begin{equation}
-b T_{i,j-1}^{n+1} - a T_{i-1,j}^{n+1} + 
\left(2a + 2b + c \right) T_{i,j}^{n+1} - 
a T_{i+1,j}^{n+1} - b T_{i,j+1}^{n+1} = 
c T_{i,j}^n + \frac{Q_{i,j}^n}{\rho c_p},
\end{equation}\]</p><p>where <span>$a = \frac{\kappa}{\Delta{x^2}}$</span>, <span>$b = \frac{\kappa}{\Delta{y^2}}$</span>, and <span>$c = \frac{1}{\Delta{t}}$</span>. </p><h4 id="Boundary-Conditions-2"><a class="docs-heading-anchor" href="#Boundary-Conditions-2">Boundary Conditions</a><a class="docs-heading-anchor-permalink" href="#Boundary-Conditions-2" title="Permalink"></a></h4><p>The temperature on the <em>ghost nodes</em> to solve the equations on the centroids adjacent to the boundary are defined as before (equations <span>$(7)-(14)$</span> ). To obtain a symmetric coefficient matrix to solve the linear system of euqations, however, one needs to modify the coefficients of the centroids adjacent to the boundary and the corresponding right-hand side, such that the equations are defined as:  </p><p><strong>Dirichlet</strong></p><p><em>West</em> (<span>$i=1$</span>)</p><p class="math-container">\[\begin{equation}
-b T_{1,j-1}^{n+1} + \left(3 a + 2b + c\right) T_{1,j}^{n+1} - a T_{2,j}^{n+1}  - b T_{1,j+1}^{n+1} = c T_{1,j}^{n} + 2 a T_{BC,W} + \frac{Q_{i,j}}{\rho c_p}, 
\end{equation}\]</p><p><em>East</em> (<span>$i = ncx$</span>)</p><p class="math-container">\[\begin{equation}
-b T_{ncx,j-1}^{n+1} - aT_{ncx-1,j}^{n+1} + \left(3 a + 2b + c\right) T_{ncx,j}^{n+1} - b T_{ncx,j+1}^{n+1} = 
c T_{ncx,j}^{n} + 2 a T_{BC,E} + \frac{Q_{i,j}}{\rho c_p}, 
\end{equation}\]</p><p><em>South</em> (<span>$j = 1$</span>)</p><p class="math-container">\[\begin{equation}
-a T_{i-1,1}^{n+1} + \left(2a + 3b + c\right) T_{i,1}^{n+1} - a T_{i+1,1}^{n+1} - bT_{i,2}^{n+1} = 
c T_{i,1}^{n} + 2 b T_{BC,S} + \frac{Q_{i,j}}{\rho c_p}, 
\end{equation}\]</p><p><em>North</em> (<span>$j = ncy$</span>)</p><p class="math-container">\[\begin{equation}
-b T_{i,ncy}^{n+1} - aT_{i-1,ncy}^{n+1} + \left(2a + 3b + c\right) T_{i,ncy}^{n+1} - a T_{i+1,ncy}^{n+1} = 
c T_{i,ncy}^{n} + 2 b T_{BC,N} + \frac{Q_{i,j}}{\rho c_p}, 
\end{equation}\]</p><p><strong>Neumann</strong></p><p><em>West</em> (<span>$i=1$</span>)</p><p class="math-container">\[\begin{equation}
-b T_{1,j-1}^{n+1} + \left(a + 2b + c\right) T_{1,j}^{n+1} - a T_{2,j}^{n+1}  - b T_{1,j+1}^{n+1} = 
c T_{1,j}^{n} - a c_W \Delta{x} + \frac{Q_{i,j}}{\rho c_p}, 
\end{equation}\]</p><p><em>East</em> (<span>$i = ncx$</span>)</p><p class="math-container">\[\begin{equation}
-b T_{ncx,j-1}^{n+1} - aT_{ncx-1,j}^{n+1} + \left(a + 2b + c\right) T_{ncx,j}^{n+1} - b T_{ncx,j+1}^{n+1} = 
c T_{ncx,j}^{n} + a c_E \Delta{x} + \frac{Q_{i,j}}{\rho c_p}, 
\end{equation}\]</p><p><em>South</em> (<span>$j = 1$</span>)</p><p class="math-container">\[\begin{equation}
-a T_{i-1,1}^{n+1} + \left(2a + b + c\right) T_{i,1}^{n+1} - a T_{i+1,1}^{n+1} - bT_{i,2}^{n+1} = 
c T_{i,1}^{n} - b c_S \Delta{y} + \frac{Q_{i,j}}{\rho c_p}, 
\end{equation}\]</p><p><em>North</em> (<span>$j = ncy$</span>)</p><p class="math-container">\[\begin{equation}
-b T_{i,ncy}^{n+1} - aT_{i-1,ncy}^{n+1} + \left(2a + b + c\right) T_{i,ncy}^{n+1} - a T_{i+1,ncy}^{n+1} = 
c T_{i,ncy}^{n} + b c_N \Delta{y} + \frac{Q_{i,j}}{\rho c_p}, 
\end{equation}\]</p><h3 id="Defection-Correction-Method"><a class="docs-heading-anchor" href="#Defection-Correction-Method">Defection Correction Method</a><a id="Defection-Correction-Method-1"></a><a class="docs-heading-anchor-permalink" href="#Defection-Correction-Method" title="Permalink"></a></h3><p>The coefficients of the matrix can be derived, for example, via: </p><p class="math-container">\[\begin{equation}
\frac{\partial{T}}{\partial{t}} - \kappa \left( \frac{\partial^2{T}}{\partial{x}^2} + \frac{\partial^2{T}}{\partial{y}^2} \right) - \frac{Q_{i,j}^n}{\rho c_p} = R, 
\end{equation}\]</p><p class="math-container">\[\begin{equation}
\frac{T_i^{n+1}-T_i^{n}}{\Delta{t}} - \kappa 
\left( \frac{T_{i-1,j}^{n+1} - 2 T_{i,j}^{n+1} + T_{i+1,j}^{n+1}}{\Delta{x}^2} + \frac{T_{i,j-1}^{n+1} - 2 T_{i,j}^{n+1} + T_{i,j+1}^{n+1}}{\Delta{y}^2}  
\right) - \frac{Q_{i,j}^n}{\rho c_p} = R,
\end{equation}\]</p><p class="math-container">\[\begin{equation}
-b T_{i,j-1}^{n+1} - a T_{i-1,j}^{n+1} + 
\left(2a + 2b + c \right) T_{i,j}^{n+1} - 
a T_{i+1,j}^{n+1} - b T_{i,j+1}^{n+1} - 
c T_{i,j}^n - \frac{Q_{i,j}^n}{\rho c_p} = 
R,
\end{equation}\]</p><p>where</p><p class="math-container">\[\begin{equation}
a = \frac{\kappa}{\Delta{x}^2},\  
b = \frac{\kappa}{\Delta{y}^2},\ 
\ \textrm{and} \ c = \frac{1}{\Delta{t}}, 
\end{equation}\]</p><p>For more details on the theory of the defect correction see <a href="../DiffOneD/">here</a> and on how this is implemented, see <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/src/HeatEquation/BackwardEuler.jl"><em>BackwardEuler.jl</em></a>.</p><h3 id="Cranck-Nicolson-Approach-(CNA)"><a class="docs-heading-anchor" href="#Cranck-Nicolson-Approach-(CNA)">Cranck-Nicolson Approach (CNA)</a><a id="Cranck-Nicolson-Approach-(CNA)-1"></a><a class="docs-heading-anchor-permalink" href="#Cranck-Nicolson-Approach-(CNA)" title="Permalink"></a></h3><p>In 2-D, equation <span>$(3)$</span> is described in a finite difference form as: </p><p class="math-container">\[\begin{equation}
\frac{T_{i,j}^{n+1} - T_{i,j}^{n}}{\Delta t} = 
\frac{\kappa}{2}\frac{(T_{i-1,j}^{n+1}-2T_{i,j}^{n+1}+T_{i+1,j}^{n+1})+(T_{i-1,j}^{n}-2T_{i,j}^{n}+T_{i+1,j}^{n})}{\Delta x^2} + 
\frac{\kappa}{2}\frac{(T_{i,j-1}^{n+1}-2T_{i,j}^{n+1}+T_{i,j+1}^{n+1})+(T_{i,j-1}^{n}-2T_{i,j}^{n}+T_{i,j+1}^{n})}{\Delta y^2}
\end{equation}\]</p><p>Rearranging equation <span>$(30)$</span> into known and unknown variables, one obtains a linear system of equations in the form of: </p><p class="math-container">\[\begin{equation}
-b T_{i,j-1}^{n+1} -aT_{i-1,j}^{n+1}+\left(2a + 2b + c\right)T_{i,j}^{n+1} -aT_{i+1,j}^{n+1} -b T_{i,j+1}^{n+1} = b T_{i,j-1}^{n} +aT_{i-1,j}^{n}-\left(2a + 2b - c\right)T_{i,j}^{n} +aT_{i+1,j}^{n} +b T_{i,j+1}^{n}
\end{equation}\]</p><p>Similar to the implicit method, we need to modify the coefficients and the right-hand side using different boundary conditions to obtain a symmetric coefficient matrix. Thus, the equations for the centroids adjacent to the boundaries are defined as: </p><p><strong>Dirichlet</strong></p><p><em>West</em> (<span>$i=1$</span>)</p><p class="math-container">\[\begin{equation}
-b T_{1,j-1}^{n+1} +
\left(3a + 2b + c \right) T_{1,j}^{n+1} 
-a T_{2,j}^{n+1} - b T_{1,j+1}^{n+1} = 
b T_{1,j-1}^{n} - \left( 3a + 2b - c \right) T_{1,j}^{n} + a T_{2,j}^{n} + b T_{1,j+1}^{n} + 4 a T_{BC,W},
\end{equation}\]</p><p><em>East</em> (<span>$i = ncx$</span>)</p><p class="math-container">\[\begin{equation}
-b T_{ncx,j-1}^{n+1} - a T_{ncx-1,j}^{n+1} +
\left(3a + 2b + c \right) T_{ncx,j}^{n+1} 
-b T_{ncx,j+1}^{n+1} = 
b T_{ncx,j-1}^{n} + a T_{ncx-1,j}^{n} -
\left( 3a + 2b - c \right) T_{ncx,j}^{n} + b T_{ncx,j+1}^{n} + 4 a T_{BC,E},
\end{equation}\]</p><p><em>South</em> (<span>$j = 1$</span>)</p><p class="math-container">\[\begin{equation}
-a T_{i-1,1}^{n+1} +
\left(2a + 3b + c \right) T_{i,1}^{n+1} - a T_{i+1,1}^{n+1} - b T_{i,2}^{n+1} = 
a T_{i-1,1}^{n} - \left( 2a + 3b - c \right) T_{i,1}^{n} + a T_{i+1,1}^{n} + b T_{i,2}^{n} + 4 b T_{BC,S},
\end{equation}\]</p><p><em>North</em> (<span>$j = ncy$</span>)</p><p class="math-container">\[\begin{equation}
-b T_{i,ncy-1}^{n+1} + a T_{i-1,ncy}^{n+1} + \left(2a + 3b + c \right) T_{i,ncy}^{n+1} - a T_{i+1,ncy}^{n+1} = 
b T_{i,ncy-1}^{n} + a T_{i-1,ncy}^{n} - \left( 2a + 3b - c \right) T_{i,ncy}^{n} + a T_{i+1,ncy}^{n} + 4 b T_{BC,N}.
\end{equation}\]</p><p><strong>Neumann</strong></p><p><em>West</em> (<span>$i=1$</span>)</p><p class="math-container">\[\begin{equation}
-b T_{1,j-1}^{n+1} + \left(a + 2b + c \right) T_{1,j}^{n+1} - a T_{2,j}^{n+1} - b T_{1,j+1}^{n+1} = 
b T_{1,j-1}^{n} - \left( a + 2b - c \right) T_{1,j}^{n} + a T_{2,j}^{n} + b T_{1,j+1}^{n} - 2 a c_W \Delta{x},
\end{equation}\]</p><p><em>East</em> (<span>$i = ncx$</span>)</p><p class="math-container">\[\begin{equation}
-b T_{ncx,j-1}^{n+1} - a T_{ncx-1,j}^{n+1} + \left(a + 2b + c \right) T_{ncx,j}^{n+1} - b T_{ncx,j+1}^{n+1} = 
b T_{ncx,j-1}^{n} + a T_{ncx-1,j}^{n} - \left( a + 2b - c \right) T_{ncx,j}^{n} + b T_{ncx,j+1}^{n} + 2 a c_E \Delta{x},
\end{equation}\]</p><p><em>South</em> (<span>$j = 1$</span>)</p><p class="math-container">\[\begin{equation}
-a T_{i-1,1}^{n+1} + \left(2a + b + c \right) T_{i,1}^{n+1} - a T_{i+1,1}^{n+1} - b T_{i,2}^{n+1} = 
a T_{i-1,1}^{n} - \left( 2a + b - c \right) T_{i,1}^{n} + a T_{i+1,1}^{n} + b T_{i,2}^{n} - 2 b c_S \Delta{y}
\end{equation}\]</p><p><em>North</em> (<span>$j = ncy$</span>)</p><p class="math-container">\[\begin{equation}
-b T_{i,ncy-1}^{n+1} + a T_{i-1,ncy}^{n+1} + \left(2a + b + c \right) T_{i,ncy}^{n+1} - a T_{i+1,ncy}^{n+1} = 
b T_{i,ncy-1}^{n} + a T_{i-1,ncy}^{n} - \left( 2a + b - c \right) T_{i,ncy}^{n} + a T_{i+1,ncy}^{n} + 2 b c_N \Delta{y}
\end{equation}\]</p><p>For more details on how this is implemented, see <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/src/HeatEquation/2Dsolvers.jl">here</a>.</p><h3 id="Alternating-Direction-Implicit"><a class="docs-heading-anchor" href="#Alternating-Direction-Implicit">Alternating Direction Implicit</a><a id="Alternating-Direction-Implicit-1"></a><a class="docs-heading-anchor-permalink" href="#Alternating-Direction-Implicit" title="Permalink"></a></h3><p>In 2-D, equation <span>$(3)$</span> for the ADI approach for each half-step in time is given as: </p><p class="math-container">\[\begin{equation}
\frac{T_{i,j}^{n+1/2}-T_{i,j}^n}{\Delta t/2} = 
\kappa 
    \left( 
    \frac{T_{i-1,j}^n-2T_{i,j}^n+T_{i+1,j}^n}{\Delta x^2} +
    \frac{T_{i,j-1}^{n+1/2}-2T_{i,j}^{n+1/2}+T_{i,j+1}^{n+1/2}}{\Delta y^2}
    \right)
\end{equation}\]</p><p class="math-container">\[\begin{equation}
\frac{T_{i,j}^{n+1}-T_{i,j}^{n+1/2}}{\Delta t/2} = 
\kappa 
    \left( 
    \frac{T_{i-1,j}^{n+1}-2T_{i,j}^{n+1}+T_{i+1,j}^{n+1}}{\Delta x^2} + 
    \frac{T_{i,j-1}^{n+1/2}-2T_{i,j}^{n+1/2}+T_{i,j+1}^{n+1/2}}{\Delta y^2}
    \right)
\end{equation}\]</p><p>This results in two linear sets of linear system of euqations with coefficient matrices for the left and right hand side of the equations. The corresponding coefficients and right hand side of each linear system of equations needs to be adjusted according to the given boundary conditions, as shown in the <em>CNA</em>, for example. For more details on how this is implemented, see <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/src/HeatEquation/2Dsolvers.jl">here</a>.</p><p>For the explicit solver and the defect correction method, one needs the extended temperature field, which includes the <em>ghost nodes</em>, to solve the <em>temperature equation</em>. Thereby, the current temperature field is assigned to the <em>centroids</em> of the extended field to use it as the <em>old</em> temperature and to calculate the temperature at the new time step. For the remaining solvers, the current temperature is assigned to the known righ-hand side vector, and one needs to collect the coefficients for each matrix to solve for the unknown temperature. </p><h2 id="Steady-State-Solution"><a class="docs-heading-anchor" href="#Steady-State-Solution">Steady State Solution</a><a id="Steady-State-Solution-1"></a><a class="docs-heading-anchor-permalink" href="#Steady-State-Solution" title="Permalink"></a></h2><p><strong>Note:</strong> So far, variable thermal parameters are only implemented in the 1-D and 2-D steady state solutions (except for the 2-D defect correction method, which also enables a time-dependent 2-D solution for variable thermal parameters). </p><p>In steady state, one assumes that the temperature does not vary over time (i.e., <span>$\frac{\partial T}{\partial t}=0$</span>) and the <em>temperature equation</em> simplifies to an <em>elliptic partial differential</em> equation (i.e., the <em>Poission equation</em>).  </p><h3 id="Poisson-Solution-(constant-*k*)"><a class="docs-heading-anchor" href="#Poisson-Solution-(constant-*k*)">Poisson Solution (constant <em>k</em>)</a><a id="Poisson-Solution-(constant-*k*)-1"></a><a class="docs-heading-anchor-permalink" href="#Poisson-Solution-(constant-*k*)" title="Permalink"></a></h3><p>For constant thermal parameters the <em>conductive</em> part of the <em>temperature equation</em> is given by: </p><p class="math-container">\[\begin{equation}
0 = \left( 
    \frac{\partial^2 T}{\partial x^2} + \frac{\partial^2 T}{\partial z^2}
    \right) + \frac{Q}{k}.
\end{equation}\]</p><p>For the approximation of the spatial partial derivatives with finite difference expressions, a central finite difference is chosen and equation <span>$(42)$</span> is then given as: </p><p class="math-container">\[\begin{equation}
0 = \left( 
\frac{T_{i-1,j} - 2T_{i,j} + T_{i+1,j}}{\Delta x^2} + \frac{T_{i,j-1} - 2T_{i,j} + T_{i,j+1}}{\Delta y^2}
\right) + \frac{Q}{k},
\end{equation}\]</p><p>where <span>$i$</span> and <span>$j$</span> are the indices for the <span>$x$</span>- and <span>$y$</span>-direction, respectively. Now, one can rearrange the equation by known (<span>$Q$</span>, <span>$k$</span>) and unknown (<span>$T$</span>) variables, wich results in a linear system of equations in the form of: </p><p class="math-container">\[\begin{equation} 
bT_{i,j-1} + aT_{i-1,j} - 2(a+b)T_{i,j} + aT_{i+1,j} + bT_{i,j+1} = -\frac{Q}{k},
\end{equation}\]</p><p>where <span>$a = \frac{1}{\Delta x^2}$</span> and <span>$b = \frac{1}{\Delta y^2}$</span>. </p><p>Here, one can again assume <em>Dirichlet</em> or <em>Neumann</em> boundary conditions, where one can use the temperature on the <em>ghost nodes</em> to properly implement the corresponding boundary conditions. Thereby, one needs to modify the coefficient matrix <strong>and</strong> the right hand side of the linear system of equations accordingly. </p><p><strong>Dirichlet</strong></p><p><em>West</em> (<span>$i=1$</span>)</p><p class="math-container">\[\begin{equation}
bT_{1,j-1} - (3a + 2b)T_{1,j} + bT_{1,j+1} + aT_{2,j} = -\frac{Q_{i,j}}{k_{i,j}} - 2aT_{BC,W}.
\end{equation}\]</p><p><em>East</em> (<span>$i=ncx$</span>)</p><p class="math-container">\[\begin{equation}
aT_{ncx-1,j} + bT_{ncx,j-1} - (3a + 2b)T_{ncx,j} + bT_{ncx,j+1} = -\frac{Q_{i,j}}{k_{i,j}} - 2aT_{BC,E}.
\end{equation}\]</p><p><em>South</em> (<span>$j=1$</span>)</p><p class="math-container">\[\begin{equation}
aT_{i-1,1} - (2a + 3b)T_{1,1} + bT_{i,2} + aT_{i+1,1} = -\frac{Q_{i,j}}{k_{i,j}} - 2bT_{BC,S}.
\end{equation}\]</p><p><em>North</em> (<span>$j=ncy$</span>)</p><p class="math-container">\[\begin{equation}
aT_{i-1,ncy} + bT_{i,ncy-1} - (2a + 3b)T_{1,ncy} + aT_{i+1,ncy} = -\frac{Q_{i,j}}{k_{i,j}} - 2bT_{BC,N}.
\end{equation}\]</p><p><strong>Neumann</strong></p><p><em>West</em> (<span>$i=1$</span>)</p><p class="math-container">\[\begin{equation}
bT_{1,j-1} - (a + 2b)T_{1,j} + bT_{1,j+1} + aT_{2,j} = -\frac{Q_{i,j}}{k_{i,j}} + ac_W\Delta{x}.
\end{equation}\]</p><p><em>East</em> (<span>$i=ncx$</span>)</p><p class="math-container">\[\begin{equation}
aT_{ncx-1,j} + bT_{ncx,j-1} - (a + 2b)T_{ncx,j} + bT_{ncx,j+1} = -\frac{Q_{i,j}}{k_{i,j}} - ac_E\Delta{x}.
\end{equation}\]</p><p><em>South</em> (<span>$j=1$</span>)</p><p class="math-container">\[\begin{equation}
aT_{i-1,1} - (2a + b)T_{1,1} + bT_{i,2} + aT_{i+1,1} = -\frac{Q_{i,j}}{k_{i,j}} + bc_S\Delta{y}.
\end{equation}\]</p><p><em>North</em> (<span>$j=ncy$</span>)</p><p class="math-container">\[\begin{equation}
aT_{i-1,ncy} + bT_{i,ncy-1} - (2a + b)T_{1,ncy} + aT_{i+1,ncy} = -\frac{Q_{i,j}}{k_{i,j}} - bc_N\Delta{y}.
\end{equation}\]</p><p>For more details on how this is implemented see <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/src/HeatEquation/2Dsolvers.jl">here</a>.</p><h3 id="Poisson-Solution-(variable-*k*)"><a class="docs-heading-anchor" href="#Poisson-Solution-(variable-*k*)">Poisson Solution (variable <em>k</em>)</a><a id="Poisson-Solution-(variable-*k*)-1"></a><a class="docs-heading-anchor-permalink" href="#Poisson-Solution-(variable-*k*)" title="Permalink"></a></h3><p>For variable thermal parameters the steady-state temperature equation is given by (in 2-D): </p><p class="math-container">\[\begin{equation} 
0 = \frac{\partial}{\partial x}\left(k_x\frac{\partial T}{\partial x}\right) + 
\frac{\partial}{\partial y}\left(k_y\frac{\partial T}{\partial y}\right) + Q_{i,j} 
\end{equation}\]</p><p>To properly solve equation <span>$(53)$</span>, one needs to apply a conservative finite difference scheme, such that the heat flux <span>$(q_i = k_i\frac{\partial T}{\partial i})$</span>, and thus the thermal conductivity, is defined <strong>between</strong> the centroids and the temperature <strong>on</strong> the <em>centroids</em> (see Figure 1). Considering such a staggered finite difference grid, equation <span>$(53)$</span> results in a linear system of equations in the form of: </p><p class="math-container">\[\begin{equation} 
b k_{y;i,j} T_{i,j-1} + a k_{x;i,j} T_{i-1,j} + c T_{i,j} + a k_{x;i+1,j} T_{i+1,j} + b k_{y;i,j+1} T_{i,j+1} + Q_{i,j} = 0,  
\end{equation}\]</p><p>where </p><p class="math-container">\[a = \frac{1}{\Delta{x^2}},
b = \frac{1}{\Delta{y^2}}, \textrm{and} \ 
c = -a\left(k_{x;i+1,j}+k_{x;i,j}\right) - b\left(k_{y;i,j+1}+k_{y;i,j}\right).\]</p><p>For more details on how this is implemented see <a href="https://github.com/LukasFuchs/GeoModBox.jl/blob/main/src/HeatEquation/2Dsolvers.jl">here</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../DiffOneD/">« 1D</a><a class="docs-footer-nextpage" href="../listoffunctions/">List of functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Monday 7 April 2025 19:55">Monday 7 April 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
